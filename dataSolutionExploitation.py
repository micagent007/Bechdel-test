import os
path = 'C:\\Users\\arthu\\Desktop\\ENPC\\2A\\1S\\Hack\\2_Test_Bechdel\\voxconverse\\rttm\\'

ListFiles = os.listdir(path) # A list of all the files in the folder (our data set)

"""dataSolution={}

for file in ListFiles:
    dataSolution[file]={}
    f = open('C:\\Users\\arthu\\Desktop\\ENPC\\2A\\1S\\Hack\\2_Test_Bechdel\\voxconverse\\rttm\\'+file,'r')
    Script = f.read().split(" ")
    for k in range((len(Script)+1)//10):
        user = dataSolution[file].get(Script[9*k+7].lstrip('spk'))
        if user is None:
            dataSolution[file][Script[9*k+7].lstrip('spk')]=[(float(Script[9 * k + 3]), float(Script[9 * k + 4]) + float(Script[9 * k + 3]))]
        else:
            dataSolution[file][Script[9*k+7].lstrip('spk')]+=[(float(Script[9 * k + 3]), float(Script[9 * k + 4]) + float(Script[9 * k + 3]))]
    # we want to class the speaker, so firts people who speak are 0, ...
    c,cont=0,True
    while cont:
        name='0'+str(c)
        if c>9:
            name=str(c)
        user = dataSolution[file].get(name)
        if user is None:
            cont=False
        else:
            dataSolution[file][name].sort(key = lambda x: x[0])
            c+=1
    f.close()
"""
dataSolution2={}

for file in ListFiles:
    dataSolution2[file] = []
    f = open('C:\\Users\\arthu\\Desktop\\ENPC\\2A\\1S\\Hack\\2_Test_Bechdel\\voxconverse\\rttm\\' + file, 'r')
    Script = f.read().split(" ")
    for k in range((len(Script) + 1) // 10):
        dataSolution2[file].append((Script[9 * k + 7].lstrip('spk'),float(Script[9 * k + 3]), float(Script[9 * k + 4]) + float(Script[9 * k + 3])))
    # we want to class the speaker, so firts people who speak are 0, ...
    dataSolution2[file].sort(key=lambda x: x[1])
    List=[dataSolution2[file][k][0] for k in range (len(dataSolution2[file]))]
    L=list(dict.fromkeys(List))
    C=[]
    for i,k in enumerate(L):
        name = '0' + str(i)
        if i > 9:
            name = str(i)
        C.append((k,name))
    Newdata=[]
    for l in range (len(dataSolution2[file])):
        for k in range(len(C)):
            if dataSolution2[file][l][0]==C[k][0]:
                Newdata.append((C[k][1],dataSolution2[file][l][1],dataSolution2[file][l][2]))
    dataSolution2[file]=Newdata.copy()
    f.close()

# Now we have a dictionary where for each audio there is a key for each speeker with a list of all his intervention (tuple of where he start to speak and where he finish)
print(dataSolution2['afjiv.rttm'])


